#######################
## output of pdf2txt ##
#######################

Transactions of the Association for Computational Linguistics, vol. 3, pp. 1–13, 2015. Action Editors: Johan Bos, Lillian Lee.
Submission batch: 6/2014; Revision batch 9/2014; Published 1/2015. c(cid:13)2015 Association for Computational Linguistics.

1

ReasoningaboutQuantitiesinNaturalLanguageSubhroRoyUniversityofIllinois,UrbanaChampaignsroy9@illinois.eduTimVieiraJohnsHopkinsUniversitytim.f.vieira@gmail.comDanRothUniversityofIllinois,UrbanaChampaigndanr@illinois.eduAbstractLittleworkfromtheNaturalLanguageProcessingcommunityhastargetedtheroleofquantitiesinNaturalLanguageUnderstanding.Thispapertakessomekeystepstowardsfacilitatingreasoningaboutquantitiesexpressedinnaturallanguage.Weinvestigatetwodifferenttasksofnumericalreasoning.First,weconsiderQuantityEntailment,anewtaskformulatedtounderstandtheroleofquantitiesingeneraltextualinferencetasks.Second,weconsidertheproblemofautomaticallyunderstandingandsolvingelementaryschoolmathwordproblems.Inordertoaddressthesequantitativereasoningproblemsweﬁrstdevelopacomputationalapproachwhichweshowtosuccessfullyrecognizeandnormalizetextualexpressionsofquantities.Wethenusethesecapabilitiestofurtherdevelopalgorithmstoassistreasoninginthecontextoftheaforementionedtasks.1IntroductionEveryday,newspaperarticlesreportstatisticstopresentanobjectiveassessmentofthesituationstheydescribe.Fromelectionresults,numberofcasualtiesinaccidents,tochangesinstockprices,textualrepresentationsofquantitiesareextremelyimportantincommunicatingaccurateinformation.However,relativelylittleworkinNaturalLanguageProcessinghasanalyzedtheuseofquantitiesintext.Eveninareaswherewehaverelativelymaturesolutions,likesearch,wefailtodealwithquantities;forexample,onecannotsearchtheﬁnancialmediafor“transactionsinthe1-2millionpoundsrange.”Languageunderstandingoftenrequirestheabilitytoreasonwithrespecttoquantities.Consider,forexample,thefollowingtextualinference,whichwepresentasTextualEntailmentquery.RecognizingTextualEntailment(RTE)(Daganetal.,2013)hasbecomeacommonwaytoformulatetextualinferenceandwefollowthistrend.RTEisthetaskofdeterminingwhetherthemeaningofagiventextpassageTentailsthatofahypothesisH.Example1T:AbombinaHebrewUniversitycafeteriakilledﬁveAmericansandfourIsraelis.H:AbombingatHebrewUniversityinJerusalemkilledninepeople,includingﬁveAmericans.Here,weneedtoidentifythequantities“ﬁveAmericans”and“fourIsraelis”,aswellasusethefactthat“Americans”and“Israelis”are“people”.Adifferentﬂavourofnumericreasoningisrequiredinmathwordproblems.Forexample,inExample2Ryanhas72marblesand17blocks.Ifhesharesthemarblesamong9friends,howmanymarblesdoeseachfriendget?onehastodeterminetherelevantquantitiesinthequestion.Here,thenumberofblocksinRyan’spossessionhasnobearingontheanswer.Thesecondchallengeistodeterminetherelevantmathematicaloperationfromthecontext.Inthispaper,wedescribesomekeystepsnecessarytofacilitatereasoningaboutquantitiesinnaturallanguagetext.Weﬁrstdescribeasystemdevelopedtorecognizequantitiesinfreeformtext,inferunitsassociatedwiththemandconvertthemto2

astandardizedform.Forexample,inExample3Aboutsixandahalfhourslater,Mr.Armstrongopenedthelandingcraft’shatch.wewouldliketoextractthenumber6.5,thecorrespondingunit,“hour”,andalsodeterminethatthequantitydescribesanapproximateﬁgure,notanexactone.Oneofthedifﬁcultiesisthatanynounornounphrasecanbeaunit,andinferringthemrequiresanalyzingcontextualcuesandlocalsentencestructure.Asweshow,insomecasesdeeperNLPtechniquesarerequiredtosupportthat.Wethendevelopareasoningframeworkforquantitiesthatwebelievecanplayanimportantroleingeneralpurposetextualinference.IsolatingthequantityreasoningcomponentoftheRTEtask,wedeﬁneQuantityEntailment(QE)-thetaskofdeterminingwhetheragivenquantitycanbeinferredfromagiventextsnippet,andthendescribeourapproachtowardssolvingit.ThisallowsustosupporttheinferencepresentedinExample1.Asanadditionalevaluation,wealsoshowtheeffectivenessofoursystemonanapplicationofQE,asearchforrangesofcurrencyvalues.Givenaqueryrange,sayfrom1millionUSDto3millionUSD,wewanttoﬁndallmentionsofmoneywithvaluesinthisrange.Usingstandardsearchenginetechnologytoqueryallvaluesintherange,inthevariousformstheycouldbeexpressed,isnotfeasible.Instead,weuseourproposedapproachtoextractmonetarymentionsfromtextandnormalizethem,andthenweuseQEtoverifythemagainstthequery.Wenextdevelopareasoningframeworkforelementaryschoolmathwordproblems.Ourreasonermakesuseofseveralclassiﬁerstodetectdifferentpropertiesofawordproblem,andﬁnallycombinesthedecisionsofindividualclassiﬁerstoobtainthecorrectanswer.Wedevelopandannotatedatasets1forevaluation,andshowthatourapproachcanhandletheaforementionedreasoningtasksquitewell.Thenextsectionpresentssomerelatedworkonquantitiesandreasoning.Wethenformallydeﬁneaquantityanddescribeourknowledge1Thedatasetsareavailablefordownloadathttp://cogcomp.cs.illinois.edu/page/resourceview/95.Therelatedsoftwareisavailableathttp://cogcomp.cs.illinois.edu/page/softwareview/Quantiﬁer.representation.Thefollowingsectionsdescribequantitiesextractionandstandardization.WenextpresenttheformulationofQuantityEntailment,anddescribeourreasoningframeworkforit.Wethendescribeourapproachtowardsunderstandingelementaryschoolmathproblems,andconcludewithexperimentalevaluation.2RelatedWorkTheimportanceofreasoningaboutquantitieshasbeenrecognizedandstudiedfrommultipleperspectives.Quantitieshavebeenrecognizedasanimportantpartofatextualentailmentsystem(deMarneffeetal.,2008;MaccartneyandManning,2008;Garouﬁ,2007;Sammonsetal.,2010),and(deMarneffeetal.,2008)claimsthatdiscrepanciesinnumbersareacommonsourceofcontradictionsinnaturallanguagetext.Theauthorsdescribeacorpusofreal-lifecontradictorypairsfrommultiplesourcessuchasWikipediaandGoogleNewsinwhichtheyfoundthat29%ofthecontradictionswereduetonumericdiscrepancies.Inaddition,theyanalyzedseveralTextualEntailmentdatasets(Daganetal.,2006)andfoundthatnumericcontradictionsconstitute8.8%ofcontradictoryentailmentpairs.Quantitativereasoninghasalsobeenaddressedfromtheperspectiveofformalsemantics.Montague(Montague,1973)investigatesidentityambiguitiesinsentences,e.g.,whether“Thetemperatureisninetybutitisrising.”implies“ninetyisrising”.Hissolutionsuggeststhat“temperature”shouldbetreatedasaconcept,and“temperatureisninety”assertsanattributeoftemperatureataparticularinstanceoftime,andnotanattributeoftheconcept“temperature”.Reasoningaboutquantitiesoftendependsonreasoningaboutmonotonicity.TheroleofmonotonicityinNLreasoninghasbeendescribedin(BarwiseandCooper,1981).Theauthorscategorizenounphrasesasupwardordownwardmonotonic,andalsodetectconstructswheremonotonicitydependsoncontext.Thelargeroleofmonotonicityinreasoningmotivatedattemptstoreasondirectlyatthesurfacelevel(Purdy,1991),ratherthanconvertingﬁrsttologicalforms.Ourapproachadvocatesthisdirectiontoo.(Kuehne,2004a)investigatesthevariouscasesinwhichphysicalquantitiesarerepresented3

indescriptionsofphysicalprocesses.Later,in(Kuehne,2004b),asystemtoextractQualitativeProcessTheory(Forbus,1984)representationsisimplementedforacontrolledsubsetoftheEnglishlanguage.Otherworksthatarerelevanttoquantities,suchasworkonthepluralsemanticsofnounphrases(Schwertel,2003),werealsodoneoncontrolledEnglish.WhiletheseapproachesdonotscaletounrestrictedEnglish,theyhaveinﬂuencedthequantityrepresentationthatweuse.Theimportanceofquantitieshasalsobeenrecognizedinsomeapplicationareas.Forexample,(Banerjeeetal.,2009)investigatesrankingofsearchresultsinvolvingquantities.Inordertodetectquantitiesintext,theyusearulebasedsystem,comprising150rules.However,theruleswerespeciﬁctothequeriesused,anddonotextendwelltounrestrictedEnglish.Incontrast,oursystemisdesignedtodetectanyquantitymentionedinnaturallanguagetext,aswellasinfertheunitassociatedwithit.Therehasalsobeensomeworkonquantitiesinspeciﬁcdomains,suchasthetemporaldomain,themostsigniﬁcantbeingtheTimeMLproject(Pustejovskyetal.,2003;Sauretal.,2005;Pratt-Hartmann,2005;Doetal.,2012).Theproblemofautomaticallysolvingmathwordproblemshasalsobeeninvestigated.Approachesrangefromusingrule-basedmethods(Bobrow,1964;Levetal.,2004;MukherjeeandGarain,2008)torecenttemplatematchingtechniques(Kushmanetal.,2014).3RepresentingQuantitiesIngeneral,quantityreferstoanythingwhichismeasurable.Ourquantitiesrepresentationisinﬂuencedbytheoneproposedin(Forbus,1984)butweproposeasimplerversionoftheirQualitativeProcesstheory:Deﬁnition(Quantity-ValueRepresentation)InQuantity-ValueRepresentation(QVR),aquantityisrepresentedasatriple(v,u,c),whereconstituentsinthetriplecorrespond,respectively,to:1.Value:anumericvalue,range,orsetofvalueswhichmeasuretheaspect,e.g.morethan500,oneortwo,thousands,March18,1986.Thevaluecanalsobedescribedviasymbolicvalue(e.g.,“belowthefreezingpoint”).Wedonotstoresurfaceformsexplicitly,butconvertthemtoasetorrange.Forexample,“morethan500”isstoredastherange(500,+∞).DetailsoftheseconversionsaregiveninSection4.2.2.Units:anounphrasethatdescribeswhatthevalueisassociatedwith.e.g.,inches,minutes,bananas.Thephrase“USsoldiers”inthephrase“FiveUSsoldiers”isaunit.3.Change:speciﬁeshowtheparameterischanging,e.g.,increasing.Thisconstituentoftenservesasanindicationofwhetherornotthevalueisrelativetoanother.Forexample,“Shewillreceivean[additional50centsperhour]”,“Thestock[increased10percent]”,“Jimhas[5ballsmore]thanTim”.4ExtractionofQuantitiesInthissectionwedescribetheﬁrstcomponentofourapproach,thatofidentifyingquantitiesandunitsintextandstandardizingtheirrepresentation.Weuseaatwostepapproachtoextractquantitiesfromfreeformtext.1.SegmentationThissteptakesrawtextandﬁndssegmentsofcontiguoustextwhichdescribequantities.2.StandardizationUsingthephrasesextractedinthepreviousstep,wederivetheQVR.AnoverviewofourmethodisgiveninAlgorithm1.Algorithm1QuantityExtraction(T)Input:TextTOutput:SetofQuantity-valuetriplesextractedfromT1:Q←∅2:S←Segmentation(T)3:forallsegments∈Sdo4:q←Standardization(s)5:ifunitofqnotinferredthen6:q←InferUnitFromSemantics(q,s,T)7:endif8:Q←Q∪{q}9:endfor10:returnQWemodelthesegmentationstepasasequencesegmentationtaskbecausequantitiesoftenappear4

assegmentsofcontiguoustext.WeadaptandcomparetwoapproachesthatwerefoundsuccessfulinprevioussequentialsegmentationworkinNLP:1.ASemi-CRFmodel(SarawagiandCohen,2004),trainedusingastructuredPerceptronalgorithm(Collins,2002),withParameterAveraging(FreundandSchapire,1998).2.Abankofclassiﬁersapproach(PunyakanokandRoth,2001)thatweretrainwithanewsetoffeatures.Thesamefeaturesetwasusedforbothapproaches.DespitetheadditionalexpressivepowerofCRFs,wefoundthatthebankofclassiﬁers(whichisfollowedbyasimpleandtractableinferencestep)performsbetterforourtask,andalsorequiressigniﬁcantlylesscomputationtime.4.1FeaturesForeachtokenxiintheinputsequenceweextractthefollowingfeatures:1.Wordclassfeatures:xiappearsinalistofknownscientiﬁcunits(e.g.,meters,Fahrenheit),writtennumbers(e.g.,two,ﬁfteen),namesofamonths,dayoftheweek,miscellaneoustemporalwords(e.g.today,tomorrow),currencyunits,etc.2.Character-based:xicontainsadigit,isalldigits,hasasufﬁx(st,nd,rd,th).3.Partofspeechtags:weusetheIllinoisPOSTagger(RothandZelenko,1998).4.Mostofthefeaturesweregeneratedfromawindowof[−3,3]aroundthecurrentword.Additionalfeaturesweregeneratedfromthesebyconjoiningthemwithoffsetvaluesfromthecurrentword.4.2MappingTextSegmentsintoQVRWedeveloparule-basedstandardizationstep,thatisinformed,asneeded,bydeeperNLprocessing,includingsemanticrolelabeling(SRL,(Palmeretal.,2010))andCo-referenceresolution.Somekeystepsofthisprocedureareasfollows:1.Convertwrittennumberstoﬂoatingpoint:e.g.,threethousandﬁvehundredtwenty→3520.02.Convertdatestoaninternaldatetype:e.g.,March18th→Date(03/18/XXXX)3.Replaceknownnamesforranges:e.g.,teenage→[13,19]years-old.4.Convertallscientiﬁcunitstoastandardbaseunit:e.g.,1mile→1609.344meters.5.Replacenon-scientiﬁcunitswithWordNetsynsets6.Rewriteknownunitstoastandardunit:e.g.,USD,US$,dollars→US$.7.Standardizechangingquantity:e.g.,“additional10books”→+10[book].8.Extractbounds:weusealistofphrases,suchas“morethan”,“lessthan”,“roughly”,“nearly”.Bydefault,ifaboundkeywordisnotpresentweassumetheboundis“=”.9.Modifyvalueusingbounds:Weconvertvalueswhichhaveaboundtoarangeofvalues.Scalarimplicatureistakenintoconsiderationhere.Considerthesentence“Johnbought10books.”,althoughitcanbeinterpretedthatbuying5booksisacorollaryofbuying10,inthiscase,wemaketheassumptionthat5bookswerenotpurchased.Seesection5.2foradiscussiononthesubject.Weusethefollowingrules,wherevisthevalueextractedbeforeusingboundinformation.•≤v→(−∞,v],similarlyfor≥,<,>.•=v→{v}•≈v→[v−c.v,v+c.v],weusec=0.2.4.3ExtractionofUnitsInmostcases,theunitsrelatedtothenumericvaluesappearadjacenttothem.Forexample,inthesentence“Therearetwobooksonthetable”,theunit“book”follows“two”.Thesequencesegmentationgroupsthesewordstogether,fromwhichitiseasytoextracttheunit.However,insomecases,abetterunderstandingofthetextisneededtoinfertheunits.Considerthefollowingexample:5

Example4AreportfromUNAIDS,theJointUnitedNationsProgramonHIV/AIDS,releasedonTuesday,showsthenumberofadultsandchildrenwithHIV/AIDSreached39.4millionin2004.Here,weneedtoknowthat“39.4million”refersto“thenumberofadultsandchildrenwithHIV/AIDS”.Also,in:Example5Thenumberofmembernationswas80in2000,andthenitincreasedto95.weneedtoknowthatthepronoun“it”refersto“thenumberofmembernations”.Weemployasequentialprocessinourstandardization.Incasetheﬁrststepdescribedabovefailstoextractunits,wemakeuseofdeeperprocessingofthesentencetoaccomplishthat(seeanevaluationofthecontributionofthisintheexperimentalsection).ThesestepsaredenotedbythefunctionInferUnitFromSemantics()inAlgorithm1.WeapplycoreferenceresolutiontoidentifypronounreferentsandthenapplyaSemanticRoleLabeler,torecognizewhichtermsareassociatedwiththequantity,andcanbepotentialunits.Inthecaseofexample4,theSRLtellsusthatfortheverb“reached”,theassociatedsubjectis“thenumberofadultsandchildrenwithHIV/AIDS”andtheobjectisthemention“39.4million”.Hence,weconcludethatthesubjectcanbeacandidatefortheunitof“39.4million”.Forthepurposeofentailment,wekeeptheentiresetofpossiblewordchunks,whicharelinkedbytheSRLtoourquantitymention,ascandidateunits.Sincemostunitsarefoundinpositionsadjacenttothenumericmention,weoptimizeonruntimebyapplyingtheSRLandcoreferenceresolveronlywhenthesegmentedchunkdoesnothaveadequateinformationtoinfertheunit.WeusetheIllinoisCoreferenceResolver(BengtsonandRoth,2008;Changetal.,2013)andtheIllinoisSRL(Punyakanoketal.,2008),forcoreferenceandsemanticrolelabelling,respectively.5QuantityEntailmentInthissectionwedescribeourapproachtoquantitativereasoningfromnaturallanguagetext.WeﬁrstformulatethetaskofQuantityEntailment,andthendescribeourreasoningframework.Deﬁnition(QuantityEntailment)GivenatextpassageTandaQuantity-Valuetripleh(ch,vh,uh),QuantityEntailmentisa3-waydecisionproblem:1.entails:thereexistsaquantityinTwhichentailsh.2.contradicts:noquantityinTentailsh,butthereisaquantityinTwhichcontradictsh.3.norelation:thereexistsnoquantityinT,whichiscomparablewithh.Theneedtoidentifysub-problemsoftextualinference,inthecontextoftheRTEtask,hasbeenmotivatedby(Sammonsetal.,2010).QuantityEntailmentcanbeconsideredasonesuchstep.SinceweenvisionthatourQEmodulewillbeonemoduleinanRTEsystem,weexpectthattheRTEsystemwillprovideitwithsomecontrolinformation.Forexample,itisoftenimportanttoknowwhetherthequantityismentionedinanupwardordownwardmonotoniccontext.SinceweareevaluatingourQEapproachinisolation,wewillalwaysassumeupwardmonotonicity,whichisalotmorecommon.Monotonicityhasbeenmodeledwithsomesuccessinentailmentsystems(MaccartneyandManning,2008),thusprovidingaclearandintuitiveframeworkforincorporatinganinferenceresourceliketheQuantityEntailmentmoduleintoafulltextualentailmentsystem.5.1ReasoningFrameworkOurQuantityEntailmentprocesshastwophases:ExtractionandReasoning.IntheExtractionPhase,wetakeatextpassageTandextractQuantity-Valuetriples(value,units,change)fromit.IntheReasoningphase,weapplyalightweightlogicalinferenceproceduretothetriplesextractedfromTtocheckifhcanbederived.TherearetwotypesofrulesappliedintheReasoningphase:ImplicitQuantityProductionsandQuantityComparisons.ThecombinationoftheserulesprovidesgoodcoveragefortheQEtask.5.1.1QuantityComparisonQuantityComparisoncomparesaquantityt:(vt,ut,ct)extractedfromTandthequantityh:(vh,uh,ch)anddecideswhetherhcanbederivedviasometruthpreservingtransformationoft.There6

arethreepossibilities:(tentailsh),(tcontradictsh),or(thasnorelationwithh).TheoverviewisgiveninAlg.2,whichisdesignedunderourassumptionthatentailingquantitiesshouldrespectupwardmonotonicity.Thisrequiresmonotonicityveriﬁcationofbothunitsandvalues.Inorderforaquantitytocontradictorentailanother,theirunitsmustbecomparable.Determiningthecomparabilityofscientiﬁcunitsisdirectsincetheyformaclosedset.Comparingnon-scientiﬁcunitsismoreinvolved.Theinferenceruleusedhereisasfollows:ifthesyntacticheadsoftheunitphrasesmatch(i.e.,thereisanIs-Aorsynonymyrelationineitherdirection),thenthephrasesarecomparable.ThesecomparisonsareencodedasafunctioncomparableUnits(ut,uh),whichreturnstrueiftheunitsutanduharecomparable,orelsereturnsfalse.Iftheunitsarecomparable,thedirectionofmonotonicity(i.e.,thedirectionoftheIs-Arelationbetweentheheadsandtheeffectsofanyrelevantmodiﬁers)isveriﬁed.ThefunctioncheckMonotonicityOfUnits(ut,uh)returnstrue,ifutismorespeciﬁcthanuh,falseotherwise.TocomputetheIs-AandsynonymyrelationsweuseWordNet(Milleretal.,1990),anontologyofwordswhichcontainstheserelations.WealsoaugmentWordNetwithtwolistsfromWikipedia(speciﬁcally,listsofNationalitiesandJobs).Next,wecheckwhetherthevaluesofthequantitiescomparedobeythemonotonicityassumption;wesaythatvtismorespeciﬁcthanvhifvtisasubsetofvh.(Notethatvtandvharebothrepresentedassetsandhence,checkingsubsetrelationisstraightforward.)Forexample,“morethan50”⊆“atleast10”.Thisrulealsoappliestodates,e.g.“03/18/1986”⊆“March1986”.Respectingscalarimplicature,weassumethat“5”issubsetof“lessthan10”,butnot“10”.Similartothecaseofunits,weusethefunctioncheckMonotonicityOfValues(vt,vh)whichreturnstrue,ifvtismorespeciﬁcthanvh,andfalseotherwise.Aquantitywhichrepresentssomeformofchangeofaquantitycannotbederivedfromaquantitywhichdoesnotrepresentchangeandviceversa.Wesetct=trueiftdenoteschangeinaquantity,otherwisewesetct=false.Algorithm2QuantityComparison(t,h)Input:Quantity-valuetriplest(vt,ut,ct)andh(vh,uh,ch)Output:Returnswhethertentails,contradictsorhasnorelationwithh1:ifct6=chthen2:returnnorelation3:endif4:ifcomparableUnits(ut,uh)=falsethen5:returnnorelation6:endif7:ifcheckMonotonicityOfUnits(ut,uh)=truethen8:ifcheckMonotonicityOfValues(vt,vh)=truethen9:returnentails10:endif11:endif12:returncontradicts5.1.2ImplicitQuantityProductionRulesTherearemanyrelationshipsamongquantitieswhichcanbethesourceofimplicitinformation.Thefollowingisanincomplete,butrelativelybroadcoveragelistofcommonpatterns:1.Rangemayimplyduration,e.g.,“JohnlivedinMiamifrom1980to2000”impliesthatJohnlivedinMiamiforadurationof20years.2.Compatibletermsmaybecombinedandabstracted.Thesentence“Ibought3bananas,2oranges,and1apple”impliesthat6fruitswerepurchased.3.Ratioscanimplypercentages.Thesentence“9outofthe10dentistsinterviewedrecommendbrushingyourteeth”impliesthat90%ofthedentistsinterviewedrecommendbrushing.4.Composition:Quantitiesandunitsmaysometimesbecomposed.Considerthefollowingexamples,thephrase“sixKoreancouples”meansthatthereare12people;thephrase“Johngavesix30-minutespeeches”impliesthatJohnspokefor180minutes.Therulesusedforproducingimplicitquantitiesemployedinoursystemarethefollowing:7

•(aratiob)ifaisapercentage,thenmultiplyitsvaluewiththevalueofbtoobtainanewquantitywiththeunitsofb.•(aratiob)ifaisnotpercentage,divideitsvaluewiththevalueofbtoobtainanewquantitywiththeunitsofb.•(arangeb)takethedifferenceofthetwovaluestoobtainanewquantitywiththeappropriatechangeofunits,e.g.,time-stampminustime-stampresultsinunitsoftime.Algorithm3QuantityEntailment(T,h)Input:TextTandaquantity-valuetriplesh(vh,uh,ch)Output:ReturnswhetherTentails,contradictsorhasnorelationwithh1:Q←QuantityExtraction(T)2:Q0←GenerateImplicitQuantities(Q)3:Q←Q∪Q04:contradict←false5:forallquantity-valuetripleq∈Qdo6:ifQuantityComparison(q,h)=entailsthen7:returnentails8:endif9:ifQuantityComparison(q,h)=contradictsthen10:contradict←true11:endif12:endfor13:ifcontradict=truethen14:returncontradicts15:else16:returnnorelation17:endif5.1.3LightweightLogicalInferenceTheQEinferenceproceduresimplyapplieseachoftheimplicitquantityproductionrulestotheQuantity-ValuetriplesextractedfromthepassageT,untilnomorequantitiesareproduced.ThenitcompareseachquantitytextractedfromTwiththequantityh,accordingtothequantitycomparisonrulesdescribedinAlgorithm2.IfanyquantityinTentailsh,then“entails”isreported;ifthereisnoquantityinTwhichcanexplainh,butthereexistsonewhichcontradictsh,then“contradiction”isreported;otherwise“norelation”isreported.ThecompleteapproachtoQuantityEntailmentisgiveninAlgorithm3.5.2ScopeofQEInferenceOurcurrentQEprocedureislimitedinseveralways.Inallcases,weattributetheselimitationstosubtleanddeeperlanguageunderstanding,whichwedelegatetotheapplicationmodulethatwilluseourQEprocedureasasubroutine.Considerthefollowingexamples:T:Adamhasexactly100dollarsinthebank.H1:Adamhas50dollarsinthebank.H2:Adam’sbankbalanceis50dollars.Here,TimpliesH1butnotH2.HoweverforbothH1andH2,QEwillinferthat“50dollars”isacontradictiontosentenceT,sinceitcannotmakethesubtledistinctionrequiredhere.T:Tenstudentspassedtheexam,butsixstudentsfailedit.H:Atleasteightstudentsfailedtheexam.Hereagain,QEwillonlyoutputthatTimplies“Atleasteightstudents”,despitethesecondpartofT.QEreasonsaboutthequantities,andthereneedstobeanapplicationspeciﬁcmodulethatunderstandswhichquantityisrelatedtothepredicate“failed”.Therealsoexistslimitationsregardinginferenceswithrespecttoeventsthatcouldoccuroveraperiodoftime.In“Itwasrainingfrom5pmto7pm”oneneedstoinferthat“Itwasrainingat6pm”although“6pm”ismorespeciﬁcthan“5pmto7pm”.Thereisaneedtounderstandtheroleofassociatedverbsandentities,andthemonotonicityofthepassagestoinfertheglobalentailmentdecision.SomeaspectsofthisproblemishandledinthemathwordproblemsinSection6,butthereisstillaneedtoformalizetheroleofassociatedpredicatesanditsassociationswithquantitiesinnaturallanguage.6SolvingMathWordProblemsInthissection,wedescribeourapproachtowardsautomaticallyunderstandingandsolvingelementaryschoolmathwordproblems.Weconsideredwordproblemshavingthefollowingproperties:1.Thequestionmentionstwoorthreequantities.2.Theanswercanbecomputedbychoosing8

twoquantitiesfromthequestionandapplyingoneofthefourbasicoperations(addition,subtraction,multiplication,division)onthem.Weuseacascadeofclassiﬁersapproachforthisproblem.Wedevelopthefollowingthreeclassiﬁerstodetectdifferentpropertiesofthewordproblem.1.QuantityPairClassiﬁerThisclassiﬁerisrelevantonlyforproblemsmentioningthreequantitiesinthequestiontext.TheinputtotheclassiﬁeristhetextofthequestionQoftheproblem,andthequantitiesq1,q2,q3extractedfromthequestionQ.Theoutputistherelevantpairofquantities,thatis,thepairofquantitiesrequiredtogettheanswer,denotedas(qi,qj).Theinferenceproblemcanbewrittenasfollows:(qi,qj)←argmaxp∈PwTqpφqp(Q,p)whereP={(q1,q2),(q2,q3),(q3,q1)},φqp(·)isafeaturefunction,andwqpisalearnedweightvector.2.OperationClassiﬁerThisclassiﬁertakesasinputthequestionQoftheproblem,andtherelevantquantitypair(qi,qj)(decidedbyQuantityPairClassiﬁerincaseofquestionswiththreequantities),andoutputswhichofthefouroperationsisrequiredfortheproblem.Theinferenceinthiscaseisop←argmaxop∈OwToprφopr(Q,(qi,qj),op)whereO={+,−,×,/}.3.OrderClassiﬁerThisclassiﬁerisrelevantonlyforproblemswhichrequiresubtractionordivision.IttakesasinputthequestionQoftheproblem,therelevantpairofquantities(qi,qj)andtheoperationopbeingperformed,anddecidesthemostlikelyorderofquantitiesintheoperation,thatis,whetherweshouldperform(qiopqj)or(qjopqi).Theinferencecanbewrittenas(q0i,q0j)←argmaxp∈PwTorφor(Q,(qi,qj),op,p)whereP={(qi,qj),(qj,qi)}Algorithm4SolveWordProblem(Q)Input:TextofquestionQOutput:ReturnsanswertoquestionQ1:(q1,q2,q3)←QuantityExtraction(Q)2:(qi,qj)←QuantityPairClassiﬁer(Q)3:op←OperationClassiﬁer(Q,(qi,qj))4:(q0i,q0j)←OrderClassiﬁer(Q,(qi,qj),op)5:return(q0iopq0j)TheinferenceprocedureisgiveninAlgorithm4.Forourclassiﬁers,weuseasparseaveragedperceptronimplementedwiththeSNOWframework(Carlsonetal.,1999).Eachclassiﬁeristrainedongoldannotationsforthatparticulartask.Thefeaturesusedareasfollows:1.Unigramsandbigramsfromsentencescontainingquantities.2.POStagsfromsentenceswithquantities.3.Relevantpairofquantities,andwhethertheirunitsmatchandwhethertheirunitsarepresentinthelastsentenceofthequestion.4.Relevantoperationfortheproblem(forOperationandOrderclassiﬁers)5.Relevantorderofquantitiesfortheoperation(forOrderclassiﬁer).6.Variousconjunctionsoftheabovefeatures.7ExperimentalStudyInthissection,weseektovalidateourproposedmodeling.Weevaluateoursystem’sperformanceonfourtasks:QuantitySegmentation,QuantityEntailment,CurrencyRangeSearch,andAnsweringMathWordProblems.Wedonotdirectlyevaluateoursystem’sabilitytomaprawtextsegmentsintoourrepresentation,butinsteadevaluatethiscapabilityextrinsically,inthecontextoftheaforementionedtasks,sincegoodStandardizationisnecessarytoperformquantitativeinference.7.1DatasetsQE:Duetolackofrelatedwork,anadequatelyannotatedcorpusdoesnotexist.Thus,inordertoevaluateoursystem,weusedtwocollections:9

1.Sub-corpusoftheRTEDatasets(Daganetal.,2006)Wechoosetext-hypothesispairsfromRTE2–RTE4datasets,whichhavequantitymentionsinthehypothesis.Overall,weselected384text-hypothesispairswithquantitiesinthehypothesis.2.NewswireText600sentencesofnewswiretextwereselected,allcontainingquantitymentions.Boththesedatasetsweremanuallyannotatedwiththephraseboundariesofquantitymentionsandhadaninter-annotatoragreementof0.91.Werestrictedannotationtocontiguoussegmentsoftext.Noinstancesofimplicitquantitieswereannotated.WealsodidnotannotatethesementionswithQVRs.Limitingtheannotationstocontiguousspansoftextresultsinafewinstancesofquantitieswhichcontainmissinginformation,suchasmissingorambiguousunits,andseveralrangeandratiorelationshipswhichwerenotannotated(e.g.,wedonotannotatetherangeexpressedin“from[5million]in[1995]to[6million]in[1996]”,butdosoin“[from5millionto6million]”).IntheRTEsub-corpuswealsoannotatedentailmentpairswithinformationaboutwhichquantitiesentail,inadditiontotheboundaryinformation.Foreachquantityinthehypothesiswelabeleditaseither“entails”,“norelation”,or“contradicts”,withaninter-annotatoragreementof0.95.Therewere309entailingquantities,71contradictingquantitiesand56quantitieswhichwereunrelatedtothecorrespondingtext.Wealsomaintainedtheinformationaboutgeneralentailment,thatis,whetherthehypothesiscanbeexplainedbythetext.AnexampleofanannotatedRTEexampleisshownbelow.AnnotationExampleforRTEsub-corpusT:AbombinaHebrewUniversitycafeteriakilled[ﬁveAmericans]and[fourIsraelis].H:AbombingatHebrewUniversityinJerusalemkilled[ninepeople],including[ﬁveAmericans].“ninepeople”:entails“ﬁveAmericans”:entailsGlobalentailmentdecision:entailsAlthoughwelimitourscopetoinfertheentailmentdecisionforindividualquantitiesmentionedinhypothesis,wehopetoseefutureapproachesusetheseindividualdecisionsandcombinethemappropriatelytoobtaintheglobalentailmentdecision.CurrencySearchWedevelopedanewdatasetforevaluatingcurrencysearch.Queriesofvariousamountsofmoneylike“1000$”,“USD2million”,etc.weremadeonasearchengine,andparagraphscontainingmonetarymentionsweretakenfromthetopsearchresults.Wecollected100paragraphscontainingvariousmentionsofmonetaryvalues,andlabeledthemwiththeamountmentionedinthem.WerestrictedthedenominationstoUSdollars.Theinter-annotatoragreementwas0.98.MathWordProblemsWecreatedanewdatasetwithelementarymathwordproblems.Theproblemswerecollectedfromhttp://www.k5learning.com/andhttp://www.dadsworksheets.com/.Thelistwasfurtherprunedtokeepproblemswiththepropertieslistedinsection6.Wealsomanuallyremovedproblemsrequiringbackgroundknowledge,forexample,“Rogerreads2bookseachday.Howmanybookswillhereadin3weeks?”,whichrequiresknowingthataweekcomprises7days.Problemswithroundingissueswerealsoexcluded.Forexample,“Eachbasketcanhold9apples.Howmanybasketsarerequiredtohold10apples?”.Eachproblemwasannotatedwiththeoperationrequiredtosolvetheproblem,andtheﬁnalanswer.Table1showssomestatisticsofourdataset.#quantitiesRelevantOperationAddSubtractMultiplyDivide2228214257260310713275131Table1:Statisticsofmathwordproblemsdataset7.2QuantitySegmentationWeevaluatethephraseboundaryrecognizerontheannotatedRTEandnewswiredatasetsdescribedintheprevioussection,usingthephrase-basedF1score.WecomparetheaccuracyandrunningtimesoftheSemi-CRFmodel(SC)(SarawagiandCohen,2004)andthebankofclassiﬁersmodel(C+I)(PR)(PunyakanokandRoth,2001),using10-foldcross-validation.Notethatthestandardizercanoftenrecoverfrommistakesmadeatthesegmentationlevel.Therefore,thisperformancedoesnotnecessarilyupperboundtheperformance10

ofthenextstepinourpipeline.Thesegmentationweareaimingfordoesnotdirectlyfollowfromsyntacticstructureofasentence.Forexample,inthesentence“Theunemploymentrateincreased10%”,wewouldliketosegmenttogether“increased10%”,sincethistellsusthatthequantitydenotesariseinvalue.Also,inthesentence“ApplerestorespushemailinGermany,nearlytwoyearsafterMotorolashutitdown”wewouldliketosegmenttogether”nearlytwoyearsafter”.Weconsideraquantitytobecorrectlydetectedonlywhenwehavetheexactphrasethatwewant,otherwiseweconsiderthesegmenttobeundetected.ModelP%R%F%TrainTestTimeTimeSemi-CRF(SC)75.677.776.615.81.5C+I(PR)80.379.379.81.01.0Table2:10-foldcross-validationresultsofsegmentationaccuracyandtimerequiredforsegmentation,thecolumnsforruntimehavebeennormalizedandexpressedasratiosTable2describesthesegmentationaccuracy,aswellastheratiobetweenthetimetakenbybothapproaches.Thebankofclassiﬁersapproachgivesslightlybetteraccuracythanthesemi-CRFmodel,andisalsosigniﬁcantlyfaster.7.3QuantityEntailmentWeevaluatethecompleteQuantityEntailmentsystem,determiningtheoveralllossduetothesegmentation,aswellasthecontributionoftheCoreferenceResolverandSRL.Weshowtheperformanceof4systems.1.GOLDSEG:Usesgoldsegmentation,anddoesnotuseSRLandCoreferenceResolver.2.GOLDSEG+SEM:Usesgoldsegmentation,andalsousesSRLandCoreferenceResolvertoinferunits.3.PREDSEG:Performssegmentation,anddoesnotuseSRLandCoreferenceResolver.4.PREDSEG+SEM:Performssegmentation,andusesSRLandCoreferenceResolver.Thebaselineisanexactstringmatchingalgorithm.Itanswers“entails”ifthequantityunitandvaluearepresentinthetext,andanswers“contradicts”ifonlytheunitmatchesandthevaluedoesnot.Otherwise,itreturns“norelation”.TheresultsareshowninTable3.Notethatexactmatchonlysupports43.3%oftheentailmentdecisions.ItisalsoevidentthatthedeepersemanticanalysisusingSRLandCoreferenceimprovesthequantitativeinference.TaskSystemP%R%F%EntailmentBaseline100.043.360.5GOLDSEG98.588.092.9+SEM97.888.693.0PREDSEG94.976.284.5+SEM95.478.386.0ContradictionBaseline16.648.524.8GOLDSEG61.692.974.2+SEM64.391.575.5PREDSEG51.979.762.8+SEM52.881.164.0NoRelationBaseline41.871.952.9GOLDSEG81.176.778.8+SEM80.078.579.3PREDSEG54.075.462.9+SEM56.372.763.5Table3:ResultsofQE;AddingSemantics(+SEM)consistentlyimprovesperformance;Only43.3%ofentailingquantitiescanberecoveredbysimplestringmatching7.4CurrencyRangeSearchTable4showstheperformanceofoursystemindetectingcurrencyphrases.Weevaluateoursystemontheproportionofmonetarymentionsitrecognizedandstandardizedcorrectlyfromqueriedrangesofcurrencyvalues,andreportmicro-averagedscores.NotethatrangesearchisadirectapplicationofQE,wherethequantityisarangeofvalues,andthetextisthecorpuswewanttosearch.Allinstancesof“entails”correspondtosearchhits.Thebaselinehereisalsoastringmatchingalgorithm,whichsearchesfornumbersinthetext.SystemP%R%F%Baseline72.069.270.5PREDSEG+SEM96.093.594.8Table4:Micro-averagedaccuracyindetectingmonetarymentions11

7.5ElementaryMathWordProblemsTable5showstheperformanceofindividualclassiﬁersaswellastheabilityofoursystemtoanswercorrectlymathwordproblems,usingtheoutputoftheclassiﬁers.Theresultsarereportedwithrespectto2-foldcross-validation.Theaccuracyofeachclassiﬁerisbasedonlyontherelevantexamplesforthatparticularclassiﬁer.Forexample,QuantityPairclassiﬁerisevaluatedonproblemswiththreequantitiesinitsquestiontext,andOrderclassiﬁerisevaluatedonproblemsconcerningsubtractionordivision.CorrectAnswerdenotestheendtoendsystem,whichoutputstheanswer,afterreceivingasinputthequestiontextoftheproblem.ModuleAccuracyQuantityPair94.3Operation91.8Order95.9CorrectAnswer86.9Table5:2-foldcross-validationresultsofmathwordproblemunderstanding.CorrectAnswerindicatesperformanceofendtoendsystem,othersrepresentindividualclassiﬁerperformanceWeﬁndthattheindividualclassiﬁershavehighaccuracy,andhenceoursystemperformswellontheendtoendtask.Apotentialfuturedirectioncanbetopropagatetheuncertaintyineachclassiﬁer,whichmightfurtherimproveperformanceofthesystem.7.6QualitativeAnalysisThesegmentationmodulemademistakesindetectingexactboundariesforuncommonphrases,e.g.,“hundredsofthousandsofpeople”,and“mid-1970’s”.Detectionofmissingunitsisproblematicincaseslike“Threeeggsarebetterthantwo”.TheSRLreturns“Threeeggs”asacandidateunit,whichneedstobeprunedappropriatelytoobtainthecorrectunit.Theprimarylimitationofthereasoningsysteminbothtasksisthelackofanextensiveknowledgebase.Wordnetbasedsynsetsprovetobeinsufﬁcienttoinferwhetherunitsarecompatible.Also,therearecertainreasoningpatternsandvariousimplicitrelationsbetweenquantitieswhicharenotcurrentlyhandledinthesystem.Forexample,inferringfromthesentence“MilitantsinRwandakilledan[averageof8,000peopleperday]for[100days]”that“around800,000peoplewerekilled”.Also,implicationofratioscanbeinvolved.Forexample,thesentence“[Oneoutof100participatingstudents]willgettheaward”impliesthattherewere“100participatingstudents”,whereas“[9outof10dentists]recommendbrushing”doesnotimplytherewere10dentists.Incaseofwordproblems,oursystemmissednon-standardquestioningpatternswithinvolvedreasoning.Forexample,“Bryanhas50skittles.Benhas20M&Ms.Whohasmore?Howmanymoredoeshehave?”8ConclusionWestudiedreasoningaboutquantitiesinnaturallanguagetext.WehaveidentiﬁedanddeﬁnedaninterestingandusefulsliceoftheTextualEntailmentproblem,theQuantityEntailmenttask,andstudiedalsoquantitativereasoningproblemsthatariseinelementarymathwordproblems.OurabilitytosupportquantitativereasoningbuildsonamethodweproposedfordetectingandnormalizingquantitiesinunrestrictedEnglishtext;wedevelopedaframeworktoremovevariabilityandambiguityfromunstructuredtextbymappingitintoarepresentationwhichmakesreasoningmoretractable.OncequantitiesaremappedintoourrepresentationwecansupportthereasoningrequiredbyQuantityEntailmentandelementaryschoollevelmathwordproblems.Ourexperimentsexhibitquiteimpressiveperformanceonarangeofquantitativereasoningproblems,including87%successonsolvingmathwordproblemsthataretargetedatelementaryschoolkids.OurfutureworkwillfocusonalleviatingsomeofthelimitationsoftheinferencemoduledescribedinSection5.2.Wewouldalsoliketoextendthescopeofreasoningtothecaseofpartially-orderedquantities,andfocusondeepersemanticanalysistohandlemoreinvolvedmathwordproblems.AcknowledgmentsThisresearchwassponsoredbytheArmyResearchLaboratory(ARL)(underagreementW911NF-09-2-0053),DARPA(underagreementnumberFA8750-13-2-0008),andagrantfromAI2.Anyopinions,ﬁndings,conclusionsorrecommendationsarethoseoftheauthorsanddonotnecessarilyreﬂecttheviewoftheagencies.12

ReferencesS.Banerjee,S.Chakrabarti,andG.Ramakrishnan.2009.Learningtorankforquantityconsensusqueries.InProceedingsofthe32ndinternationalACMSIGIRconferenceonResearchanddevelopmentininformationretrieval,SIGIR’09,pages243–250,NewYork,NY,USA.ACM.J.BarwiseandR.Cooper.1981.Generalizedquantiﬁersandnaturallanguage.LinguisticsandPhilosophy,4(2):159–219.E.BengtsonandD.Roth.2008.Understandingthevalueoffeaturesforcoreferenceresolution.InEMNLP.D.Bobrow.1964.Naturallanguageinputforacomputerproblemsolvingsystem.Technicalreport,Cambridge,MA,USA.A.Carlson,C.Cumby,J.Rosen,andD.Roth.1999.TheSNoWlearningarchitecture.Technicalreport,UIUCComputerScienceDepartment.K.-W.Chang,R.Samdani,andD.Roth.2013.Aconstrainedlatentvariablemodelforcoreferenceresolution.InEMNLP.M.Collins.2002.DiscriminativetrainingmethodsforhiddenMarkovmodels:Theoryandexperimentswithperceptronalgorithms.InEMNLP.I.Dagan,O.Glickman,andB.Magnini,editors.2006.ThePASCALRecognisingTextualEntailmentChallenge.I.Dagan,D.Roth,M.Sammons,andF.Zanzotto.2013.Recognizingtextualentailment:Modelsandapplications.Marie-CatherinedeMarneffe,AnnaN.Rafferty,andChristopherD.Manning.2008.Findingcontradictionsintext.InACL.Q.Do,W.Lu,andD.Roth.2012.Jointinferenceforeventtimelineconstruction.InEMNLP.K.Forbus.1984.Qualitativeprocesstheory.ArtiﬁcialIntelligence,24:85–168.Y.FreundandR.Schapire.1998.LargemarginclassiﬁcationusingthePerceptronalgorithm.InCOLT.K.Garouﬁ.2007.Towardsabetterunderstandingofappliedtextualentailment:Annotationandevaluationoftherte-2dataset.Master’sthesis,SaarlandUniversity,Saarbrucken.S.Kuehne.2004a.Ontherepresentationofphysicalquantitiesinnaturallanguagetext.InProceedingsofTwenty-sixthAnnualMeetingoftheCognitiveScienceSociety.S.Kuehne.2004b.Understandingnaturallanguagedescriptionsofphysicalphenomena.Ph.D.thesis,NorthwesternUniversity,Evanston,Illinois.N.Kushman,L.Zettlemoyer,R.Barzilay,andY.Artzi.2014.Learningtoautomaticallysolvealgebrawordproblems.InACL(1),pages271–281.I.Lev,B.Maccartney,C.Manning,andR.Levy.2004.Solvinglogicpuzzles:Fromrobustprocessingtoprecisesemantics.InInProc.of2ndWorkshoponTextMeaningandInterpretation,ACL-04.BillMaccartneyandChristopherD.Manning.2008.Modelingsemanticcontainmentandexclusioninnaturallanguageinference.InProceedingsofthe22ndInternationalConferenceonComputationalLinguistics(Coling2008).G.Miller,R.Beckwith,C.Fellbaum,D.Gross,andK.J.Miller.1990.Wordnet:Anon-linelexicaldatabase.InternationalJournalofLexicography.R.Montague.1973.Thepropertreatmentofquantiﬁcationinordinaryenglish.InPatrickSuppes,JuliusMoravcsik,andJaakkoHintikka,editors,ApproachestoNaturalLanguage,volume49,pages221–242.Dordrecht.A.MukherjeeandU.Garain.2008.Areviewofmethodsforautomaticunderstandingofnaturallanguagemathematicalproblems.ArtiﬁcialIntelligenceReview,29(2):93–122.M.Palmer,D.Gildea,andN.Xue.2010.SemanticRoleLabeling.I.Pratt-Hartmann.2005.FromtimemltoTPL.InAnnotating,ExtractingandReasoningaboutTimeandEvents,10.-15.April2005.V.PunyakanokandD.Roth.2001.Theuseofclassiﬁersinsequentialinference.InNIPS.V.Punyakanok,D.Roth,andW.Yih.2008.Theimportanceofsyntacticparsingandinferenceinsemanticrolelabeling.ComputationalLinguistics.W.Purdy.1991.Alogicfornaturallanguage.NotreDameJournalofFormalLogic,32(3):409–425,06.J.Pustejovsky,J.Castao,R.Ingria,R.Saur,R.Gaizauskas,A.Setzer,andG.Katz.2003.TimeML:Robustspeciﬁcationofeventandtemporalexpressionsintext.IninFifthInternationalWorkshoponComputationalSemantics(IWCS-5.D.RothandD.Zelenko.1998.Partofspeechtaggingusinganetworkoflinearseparators.InCOLING-ACL,The17thInternationalConferenceonComputationalLinguistics.M.Sammons,V.G.Vydiswaran,andD.Roth.2010.”asknotwhattextualentailmentcandoforyou...”.InACL.SunitaSarawagiandWilliamW.Cohen.2004.Semi-markovconditionalrandomﬁeldsforinformationextraction.InNIPS.R.Saur,R.Knippen,M.Verhagen,andJ.Pustejovsky.2005.Evita:arobusteventrecognizerforqasystems.InProceedingsoftheconferenceon13

HumanLanguageTechnologyandEmpiricalMethodsinNaturalLanguageProcessing,HLT’05,pages700–707,Stroudsburg,PA,USA.AssociationforComputationalLinguistics.U.Schwertel.2003.PluralSemanticsforNaturalLanguageUnderstandingAComputationalProof-TheoreticApproach.Ph.D.thesis,UniversityofZurich.14



######################
## output of PY2PDF ##
######################

2



3



4



5



6



7



8



9



10



11



12



13



14



